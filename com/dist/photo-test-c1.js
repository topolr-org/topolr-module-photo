window.topolr.source({"packet":[{"p":"photo.test","h":"f36490b425","c":"/**\r\n * @packet photo.test;\r\n * @require photo.show;\r\n */\nOption({\r\n    name:\"boot\",\r\n    option:{\r\n        override:{\r\n            onendinit:function () {\r\n                // this.addChild({\r\n                //     type:\"@show.imageviewer\",\r\n                //     container:this.finders(\"container\")\r\n                // }).then(function (a) {\r\n                //     a.setImage(\"http://img.zcool.cn/community/017774590c0cfda8012145501412d9.jpg@900w_1l_2o_100sh.jpg\");\r\n                // });\r\n                this.addChild({\r\n                    type:\"@show.gallery\",\r\n                    option:{\r\n                        images:[\r\n                            {\r\n                                big:\"http://img.zcool.cn/community/017774590c0cfda8012145501412d9.jpg@900w_1l_2o_100sh.jpg\",\r\n                                thumb:\"http://img.zcool.cn/community/0319558590c0dd7a8012145506bfcea.jpg@250w_188h_1c_1e_2o_100sh.jpg\",\r\n                                desc:\"aa\"\r\n                            },\r\n                            {\r\n                                big:\"http://img.zcool.cn/community/021530590bd445a801214550a1c082.jpg\",\r\n                                thumb:\"http://img.zcool.cn/community/00662f590bd598a8012145505cfe5f.jpg@250w_188h_1c_1e_2o_100sh.jpg\",\r\n                                desc:\"bb\"\r\n                            }\r\n                        ]\r\n                    },\r\n                    container:this.finders(\"container\")\r\n                });\r\n            }\r\n        }\r\n    }\r\n});"},{"p":"photo.show","h":"9d48746521","c":"/**\r\n * @packet photo.show;\r\n * @require photo.util.canvas;\r\n * @require util.file;\r\n * @css photo.style.gallery;\r\n * @css photo.style.style;\r\n * @template photo.template.show;\r\n * @require photo.service.showservice;\r\n * @require util.uikit;\r\n */\nModule({\r\n    name: \"gallery\",\r\n    className: \"gallery\",\r\n    extend: \"viewgroup\",\r\n    layout:\"@show.gallery\",\r\n    services:{\"gallery\":\"@showservice.galleryservice\"},\r\n    option: {\r\n        images:[],\r\n        viewerType:\"@.imageviewer\",\r\n        listType:\"@.thumblist\",\r\n        listWidth:80\r\n    },\r\n    init: function (option) {\r\n        this.getService(\"gallery\").action(\"set\",this.option.images);\r\n    },\r\n    update:function (data) {\r\n        this.getChildByType(this.option.listType).setImages(data.thumbImages);\r\n        this.getChildByType(this.option.viewerType).setImage(data.currentImage.big);\r\n    },\r\n    gotoImage: function (num) {\r\n        this.getService(\"gallery\").trigger(\"gotoimage\",num);\r\n    },\r\n    nextImage: function () {\r\n        this.getService(\"gallery\").trigger(\"nextimage\");\r\n    },\r\n    prevImage: function () {\r\n        this.getService(\"gallery\").trigger(\"previmage\");\r\n    },\r\n    event_thumbclick:function (e) {\r\n        this.gotoImage(e.data.index);\r\n    }\r\n});\r\nModule({\r\n    name:\"imageviewer\",\r\n    extend:\"view\",\r\n    className:\"imageviewer\",\r\n    template:\"@show.imageviewer\",\r\n    option:{\r\n        rotateoffset: 10,\r\n        zoomoffset: 0.2,\r\n        tools: [\r\n            {type: \"zoomIn\", icon: \"mt-photo-zoom_in\"},\r\n            {type: \"zoomOut\", icon: \"mt-photo-zoom_out\"},\r\n            {type: \"rotateLeft\", icon: \"mt-photo-rotate_left\"},\r\n            {type: \"rotateRight\", icon: \"mt-photo-rotate_right\"},\r\n            {type: \"download\", icon: \"mt-photo-vertical_align_bottom\"},\r\n            {type: \"reset\", icon: \"mt-photo-refresh\"}\r\n        ]\r\n    },\r\n    init:function () {\r\n        var option=this.option;\r\n        this.render(option);\r\n        option.sceneWidth = this.dom.width();\r\n        option.sceneHeight = this.dom.height();\r\n        var canvas = require(\"@canvas\");\r\n        this.dom.width(option.sceneWidth).height(option.sceneHeight);\r\n        var scene = this.dom.display();\r\n        var baseContainer = canvas.create(\"DisplayObjectContainer\", {\r\n            id: \"aa\",\r\n            width: option.sceneWidth,\r\n            height: option.sceneHeight,\r\n            x: 0,\r\n            y: 0\r\n        });\r\n        var r = Math.sqrt(option.sceneWidth * option.sceneWidth + option.sceneHeight * option.sceneHeight);\r\n        var imageContainer = canvas.create(\"DisplayObjectContainer\", {\r\n            id: \"imageContainer\",\r\n            width: r,\r\n            height: r,\r\n            x: -(r - option.sceneWidth) / 2,\r\n            y: -(r - option.sceneHeight) / 2,\r\n            init: function () {\r\n                this.ismove = false;\r\n                this.cleft = 0;\r\n                this.ctop = 0;\r\n            },\r\n            onmousedown: function (e) {\r\n                var b = this.getChildAt(0);\r\n                var a = b.getLocalRelativeRootPoint(e.pageX, e.pageY);\r\n                this.cleft = a.x - b.x();\r\n                this.ctop = a.y - b.y();\r\n            },\r\n            onmousemove: function (e) {\r\n                if (this.ismove) {\r\n                    if (this.getChildAt(0).width() > this.getChildAt(1).width() || this.getChildAt(0).height() > this.getChildAt(1).height()) {\r\n                        var b = this.getChildAt(0);\r\n                        var a = b.getLocalRelativeRootPoint(e.pageX, e.pageY);\r\n                        var _x = a.x - this.cleft;\r\n                        var _y = a.y - this.ctop;\r\n                        if (_x < this.getChildAt(1).x()) {\r\n                            if (_x > this.getChildAt(1).x() - (this.getChildAt(0).width() - this.getChildAt(1).width())) {\r\n                                b.x(a.x - this.cleft);\r\n                            } else {\r\n                                b.x(this.getChildAt(1).x() - (this.getChildAt(0).width() - this.getChildAt(1).width()));\r\n                            }\r\n                        } else {\r\n                            b.x(this.getChildAt(1).x());\r\n                        }\r\n                        if (_y < this.getChildAt(1).y()) {\r\n                            if (_y > this.getChildAt(1).y() - (this.getChildAt(0).height() - this.getChildAt(1).height())) {\r\n                                b.y(a.y - this.ctop);\r\n                            } else {\r\n                                b.y(this.getChildAt(1).y() - (this.getChildAt(0).height() - this.getChildAt(1).height()));\r\n                            }\r\n                        } else {\r\n                            b.y(this.getChildAt(1).y());\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            onmouseup: function () {\r\n                this.ismove = false;\r\n            }\r\n        });\r\n        imageContainer.rotatePoint(option.sceneWidth / 2, option.sceneHeight / 2);\r\n        var image = canvas.create(\"ImageDisplay\", {\r\n            id: \"image\",\r\n            width: option.sceneWidth,\r\n            height: option.sceneHeight,\r\n            x: (r - option.sceneWidth) / 2,\r\n            y: (r - option.sceneHeight) / 2,\r\n            rotate: 0\r\n        });\r\n        image.rotatePoint((r - option.sceneWidth) / 2, (r - option.sceneHeight) / 2);\r\n        var squart = canvas.create(\"SquartDisplay\", {\r\n            id: \"squart\",\r\n            width: option.sceneWidth,\r\n            height: option.sceneHeight,\r\n            x: (r - option.sceneWidth) / 2,\r\n            y: (r - option.sceneHeight) / 2,\r\n            onmousedown: function () {\r\n                this.parent().ismove = true;\r\n            }\r\n        });\r\n        imageContainer.addChild(image).addChild(squart);\r\n        baseContainer.addChild(imageContainer);\r\n        scene.addChild(baseContainer);\r\n        this.image = image;\r\n        this.imageContainer = imageContainer;\r\n        this.baseContainer = baseContainer;\r\n        this.r = r;\r\n    },\r\n    bind_btn:function(dom){\r\n        var data=dom.cache(),type=data.type;\r\n        if(this[type]){\r\n            this[type](data);\r\n        }\r\n        this.dispatchEvent(type,data);\r\n    },\r\n    setImage: function (url) {\r\n        var ths = this;\r\n        $.loadingbar().showLoading(\"loading...\");\r\n        $.loader().image(url, function () {\r\n            $.loadingbar().close();\r\n            var ximage = this, _w = ximage.width, _h = ximage.height, image = ths.image;\r\n            image.canvas.width = _w;\r\n            image.canvas.height = _h;\r\n            image.props({\r\n                width: _w,\r\n                height: _h,\r\n                x: (ths.r - _w) / 2,\r\n                y: (ths.r - _h) / 2,\r\n                rotate: 0\r\n            });\r\n            image.setImage(this, \"fit\");\r\n            ths.imageContainer.rotate(0);\r\n        });\r\n    },\r\n    _resize: function () {\r\n        if (this.dom.find(\".list\").height() > this.dom.find(\".listcon\").height()) {\r\n            this.dom.find(\".listcon\").bind(\"mousemove\", function (e) {\r\n                var offset = $(this).children(0).height() - $(this).height();\r\n                var a = offset * (e.pageY - $(this).offset().top) / $(this).height();\r\n                $(this).scrollTop(a);\r\n            });\r\n        } else {\r\n            this.dom.find(\".listcon\").unbind(\"mousemove\");\r\n        }\r\n    },\r\n    zoomIn: function () {\r\n        var image = this.image, offset = this.option.zoomoffset;\r\n        var _w = image.width() + image.width() * offset;\r\n        if (_w / image.image.width <= 5) {\r\n            image.props({\r\n                width: _w,\r\n                height: image.height() + image.height() * offset,\r\n                x: image.x() - image.width() * offset / 2,\r\n                y: image.y() - image.height() * offset / 2\r\n            });\r\n        }\r\n    },\r\n    zoomOut: function () {\r\n        var image = this.image, offset = this.option.zoomoffset;\r\n        var container = this.imageContainer;\r\n        if (container.getChildAt(0).width() > container.getChildAt(1).width() || container.getChildAt(0).height() > container.getChildAt(1).height()) {\r\n            var _w = image.width() - image.width() * offset;\r\n            var _h = image.height() - image.height() * offset;\r\n            if (_w < this.option.sceneWidth) {\r\n                _w = this.option.sceneWidth;\r\n                _h = image.height() / image.width() * _w;\r\n                if (_h < this.option.sceneHeight) {\r\n                    _h = this.option.sceneHeight;\r\n                    _w = image.width() / image.height() * _h;\r\n                }\r\n            }\r\n            if (_h < this.option.sceneHeight) {\r\n                _h = this.option.sceneHeight;\r\n                _w = image.width() / image.height() * _h;\r\n                if (_w < this.option.sceneWidth) {\r\n                    _w = this.option.sceneWidth;\r\n                    _h = image.height() / image.width() * _w;\r\n                }\r\n            }\r\n            var _x = image.x() + image.width() * offset / 2;\r\n            var _y = image.y() + image.height() * offset / 2;\r\n            if (_x < container.getChildAt(1).x()) {\r\n                if (_x > container.getChildAt(1).x() - (container.getChildAt(0).width() - container.getChildAt(1).width())) {\r\n                } else {\r\n                    _x = container.getChildAt(1).x() - (container.getChildAt(0).width() - container.getChildAt(1).width());\r\n                }\r\n            } else {\r\n                _x = container.getChildAt(1).x();\r\n            }\r\n            if (_y < container.getChildAt(1).y()) {\r\n                if (_y > container.getChildAt(1).y() - (container.getChildAt(0).height() - container.getChildAt(1).height())) {\r\n                } else {\r\n                    _y = container.getChildAt(1).y() - (container.getChildAt(0).height() - container.getChildAt(1).height());\r\n                }\r\n            } else {\r\n                _y = container.getChildAt(1).y();\r\n            }\r\n            if (_w + _x < container.getChildAt(1).x() + container.getChildAt(1).width()) {\r\n                _x = container.getChildAt(1).x() + container.getChildAt(1).width() - _w;\r\n            }\r\n            if (_h + _y < container.getChildAt(1).y() + container.getChildAt(1).height()) {\r\n                _y = container.getChildAt(1).y() + container.getChildAt(1).height() - _h;\r\n            }\r\n            image.props({\r\n                width: _w,\r\n                height: _h,\r\n                x: _x,\r\n                y: _y\r\n            });\r\n        }\r\n    },\r\n    rotateRight: function () {\r\n        this.imageContainer.rotate(this.imageContainer.rotate() + this.option.rotateoffset);\r\n    },\r\n    rotateLeft: function () {\r\n        this.imageContainer.rotate(this.imageContainer.rotate() - this.option.rotateoffset);\r\n    },\r\n    download: function () {\r\n        var option = this.option;\r\n        try {\r\n            var uri = this.image.getImageDate(0, 0, this.image.image.width, this.image.image.height);\r\n            var file = require(\"@file\");\r\n            var blob = file.getBlobFromURI(uri);\r\n            file.saveAs(blob, \"photocutter.png\");\r\n        } catch (e) {\r\n            console.info(\"download error\");\r\n        }\r\n    },\r\n    reset: function () {\r\n        var ximage = this.image.image, _w = ximage.width, _h = ximage.height;\r\n        this.image.props({\r\n            width: _w,\r\n            height: _h,\r\n            x: (this.r - _w) / 2,\r\n            y: (this.r - _h) / 2,\r\n            rotate: 0\r\n        });\r\n        this.imageContainer.rotate(0);\r\n    }\r\n});\r\nModule({\r\n    name:\"thumblist\",\r\n    extend:\"view\",\r\n    template:\"@show.thumblist\",\r\n    className:\"thumblist\",\r\n    option:{\r\n        list:[]\r\n    },\r\n    init:function () {\r\n        this.render(this.option.list);\r\n    },\r\n    setImages:function (array) {\r\n        this.render(this.option.list.concat(array));\r\n    },\r\n    bind_img:function (dom) {\r\n        var data=dom.cache();\r\n        this.dispatchEvent(\"thumbclick\",data);\r\n    }\r\n});"},{"p":"photo.util.canvas","h":"1b36a803ce","c":"/*!\n * @packet photo.util.canvas;\n */\nvar factory = $.adapt();\nfactory.def({\n    name: \"DisplayObject\",\n    init: function (option) {\n        option.init && option.init.call(this, option);\n        this._id = option.id;\n        this._x = $.is.isAvalid(option.x) ? option.x : 0;\n        this._y = $.is.isAvalid(option.y) ? option.y : 0;\n        this._originalx = this._x;\n        this._originaly = this._y;\n        this._width = $.is.isAvalid(option.width) ? option.width : 10;\n        this._height = $.is.isAvalid(option.height) ? option.height : 10;\n        this._rotate = $.is.isAvalid(option.rotate) ? option.rotate : 0;\n        this._alpha = $.is.isAvalid(option.alpha) ? option.alpha : 1;\n        var cvs = document.createElement(\"canvas\");\n        cvs.width = this._width;\n        cvs.height = this._height;\n        this.canvas = cvs;\n        this.ctx = cvs.getContext(\"2d\");\n        this._minx = this._x;\n        this._miny = this._y;\n        this._maxwidth = this._width;\n        this._maxheight = this._height;\n        this.cache = {};\n    },\n    id: function (a) {\n        if (arguments.length === 0) {\n            return this._id;\n        } else {\n            this._id = a;\n            return this;\n        }\n    },\n    props: function (obj) {\n        for (var i in obj) {\n            if (this[\"_\" + i]) {\n                this[\"_\" + i] = obj[i];\n            }\n        }\n        this.redraw();\n        return this;\n    },\n    render: function () {\n    },\n    redraw: function () {\n        var a = this._parent;\n        while (a) {\n            a.draw();\n            a = a._parent;\n        }\n    },\n    _clear: function () {\n    }\n}).def({\n    name: \"DisplayEvent\",\n    init: function (option) {\n        this.eventType = option.type;\n        this.target = null;\n        this.currentTarget = null;\n        this.data = option.data || null;\n        this._goon = true;\n    },\n    stopPropagation: function () {\n        this._goon = false;\n    }\n}).def({\n    name: \"MouseEvent\",\n    extend: \"DisplayEvent\",\n    init: function (option) {\n        this.pageX = option.pageX || 0;\n        this.pageY = option.pageY || 0;\n    }\n}).def({\n    name: \"Sprite\",\n    extend: \"DisplayObject\",\n    init: function (option) {\n        this._handler = {};\n        this._parent = null;\n        this._root = null;\n        this._depth = 0;\n        this._rotatepoint = option.rotatepoint || [0, 0];\n        this._scale = 1;\n        this._event = option.event === false ? false : true;\n        for (var i in option) {\n            if (/^on/.test(i) && $.is.isFunction(option[i])) {\n                this[i] = option[i];\n            }\n        }\n    },\n    root: function () {\n        if (!this._root) {\n            var a = this;\n            while (!a.typeOf(\"root\")) {\n                a = a._parent;\n            }\n            this._root = a;\n        }\n        return this._root;\n    },\n    parent: function () {\n        return this._parent;\n    },\n    x: function (a) {\n        if (arguments.length === 0) {\n            return this._x;\n        } else {\n            this._x = a;\n            this._originalx = a;\n            this.redraw();\n            return this;\n        }\n    },\n    y: function (a) {\n        if (arguments.length === 0) {\n            return this._y;\n        } else {\n            this._y = a;\n            this._originaly = a;\n            this.redraw();\n            return this;\n        }\n    },\n    width: function (a) {\n        if (arguments.length === 0) {\n            return this._width;\n        } else {\n            this._width = a;\n            this.redraw();\n            return this;\n        }\n    },\n    height: function (a) {\n        if (arguments.length === 0) {\n            return this._height;\n        } else {\n            this._height = a;\n            this.redraw();\n            return this;\n        }\n    },\n    alpha: function (a) {\n        if (arguments.length === 0) {\n            return this._alpha;\n        } else {\n            this._alpha = a;\n            this.redraw();\n            return this;\n        }\n    },\n    rotate: function (rotate) {\n        if (arguments.length === 1 && $.is.isNumber(rotate)) {\n            this._rotate = rotate;\n            var _pp = Math.PI * (rotate / 180), rotatepoint = this._rotatepoint, x = this._originalx, y = this._originaly;\n            if (rotatepoint[1] !== 0) {\n                var R = Math.sqrt((rotatepoint[0] - x) * (rotatepoint[0] - x) + (rotatepoint[1] - y) * (rotatepoint[1] - y));\n                var offset = Math.PI - Math.atan((rotatepoint[1] - y) / (rotatepoint[0] - x)) - _pp;\n                this._x = rotatepoint[0] + R * Math.cos(offset);\n                this._y = rotatepoint[1] - R * Math.sin(offset);\n            } else {\n                this._x = x;\n                this._y = y;\n            }\n            this.redraw();\n            return this;\n        } else {\n            return this._rotate;\n        }\n    },\n    rotatePoint: function (x, y) {\n        if (arguments.length === 0) {\n            return this._rotatepoint;\n        } else {\n            this._rotatepoint = [x, y];\n            return this;\n        }\n    },\n    checkPointIn: function (x, y) {\n        return (x >= 0 && x <= 0 + this._width && y >= 0 && y <= 0 + this._height);\n    },\n    getLocalRelativeParentPoint: function (x, y) {\n        var sprite = this;\n        var _pp = Math.PI * (sprite._rotate / 180);\n        var cos = Math.cos(_pp), sin = Math.sin(_pp);\n        var ox = (x - sprite._x), oy = (y - sprite._y);\n        return{\n            x: ox * cos + oy * sin,\n            y: oy * cos - ox * sin\n        };\n    },\n    getLocalRelativeRootPoint: function (x, y) {\n        var a = [], b = this._parent;\n        while (b) {\n            a.push(b);\n            b = b._parent;\n        }\n        var mx = {\n            x: 0,\n            y: 0\n        };\n        for (var i = a.length - 1; i >= 0; --i) {\n            mx = a[i].getLocalRelativeParentPoint(x, y);\n        }\n        return mx;\n    },\n    clean: function () {\n        this.ctx.clearRect(0, 0, this._width, this._height);\n    },\n    addEventListenter: function (type, fn) {\n        if (!this._handler[type]) {\n            this._handler[type].push(fn);\n        } else {\n            this._handler[type] = [fn];\n        }\n        return this;\n    },\n    removeEventListener: function (type, fn) {\n        if (this._handler[type]) {\n            if (fn) {\n                var a = this._handler[type].indexOf(fn);\n                if (a !== -1) {\n                    this._handler[type].splice(a, 1);\n                }\n            } else {\n                this._handler[type].length = 0;\n            }\n        }\n        return this;\n    },\n    dispatchEvent: function (event) {\n        event.target = this;\n        var i = this;\n        while (i) {\n            i.privator(\"triggerEvent\", event);\n            if (event._goon) {\n                i = i._parent;\n            } else {\n                break;\n            }\n        }\n        return this;\n    },\n    getImageDate: function (x, y, width, height) {\n        var xis = x || 0, yis = y || 0, widthis = width || this._width, heightis = height || this._height;\n        var canvas = document.createElement(\"canvas\");\n        var ctx = canvas.getContext(\"2d\");\n        canvas.width = widthis;\n        canvas.height = heightis;\n        ctx.drawImage(this.ctx.canvas, xis, yis, widthis, heightis, 0, 0, widthis, heightis);\n        return canvas.toDataURL(\"image/png\");\n    },\n    _triggerEvent: function (e) {\n        e.currentTarget = this;\n        if (this._handler[e.eventType]) {\n            for (var i = 0; i < this._handler[e.eventType].length; i++) {\n                this._handler[e.eventType][i].call(this, e);\n            }\n        } else {\n            if ($.is.isFunction(this[\"on\" + e.eventType])) {\n                this[\"on\" + e.eventType].call(this, e);\n            }\n        }\n        return this;\n    }\n}).def({\n    name: \"DisplayObjectContainer\",\n    extend: \"Sprite\",\n    init: function () {\n        this.children = [];\n    },\n    addChild: function (child) {\n        if (child.typeOf && child.typeOf(\"DisplayObject\")) {\n            this.children.push(child);\n            child._depth = this.children.length;\n            child._parent = this;\n            child._root = this.typeOf(\"root\") ? this : this._root;\n        } else if ($.is.isObject(child)) {\n            if (child.displayType) {\n                var a = factory.create(child.displayType, child);\n                this.children.push(a);\n                a._depth = this.children.length;\n                a._parent = this;\n                a._root = (this._id === \"ROOT\" ? this : this._parent);\n            }\n        }\n        this.render();\n        return this;\n    },\n    getChildAt: function (num) {\n        if (num >= 0 && num < this.children.length) {\n            return this.children[num];\n        } else {\n            return null;\n        }\n    },\n    getChildById: function (name) {\n        var r = null;\n        if (name && name !== \"\") {\n            for (var i = 0; i < this.children.length; i++) {\n                if (this.children[i]._id === name) {\n                    r = this.children[i];\n                }\n            }\n        }\n        return r;\n    },\n    removeChildAt: function (num) {\n        if (num >= 0 && num < this.children.length) {\n            this.children.splice(num, 1);\n            this.render();\n        }\n        return this;\n    },\n    render: function () {\n        var ths = this;\n        this.clean();\n        ths.ctx.globalAlpha = ths._alpha;\n        this.children.forEach(function (a) {\n            ths.ctx.save();\n            a.render();\n            if (a.typeOf(\"DisplayObjectContainer\")) {\n                ths.ctx.translate(a._x, a._y);\n                ths.ctx.rotate(a._rotate / 180 * Math.PI);\n                ths.ctx.drawImage(a.canvas, 0, 0, a._width, a._height);\n            } else {\n                ths.ctx.translate(a._x, a._y);\n                ths.ctx.rotate(a._rotate / 180 * Math.PI);\n                ths.ctx.drawImage(a.canvas, 0, 0, a._width, a._height);\n            }\n            ths.ctx.restore();\n        });\n    },\n    draw: function () {\n        var ths = this;\n        this.clean();\n        ths.ctx.globalAlpha = ths._alpha;\n        this.children.forEach(function (a) {\n            ths.ctx.save();\n            if (a.typeOf(\"DisplayObjectContainer\")) {\n                ths.ctx.translate(a._x, a._y);\n                ths.ctx.rotate(a._rotate / 180 * Math.PI);\n                ths.ctx.drawImage(a.canvas, 0, 0, a._width, a._height);\n            } else {\n                ths.ctx.translate(a._x, a._y);\n                ths.ctx.rotate(a._rotate / 180 * Math.PI);\n                ths.ctx.drawImage(a.canvas, 0, 0, a._width, a._height);\n            }\n            ths.ctx.restore();\n        });\n    },\n    setdrawingsize: function () {\n        var minx = 0, maxx = this._width, maxy = this._height, miny = 0, maxwidth = this._width, maxheight = this._height;\n        for (var i in this.children) {\n            if (this.children[i]._x < 0 && this.children[i]._x < minx) {\n                minx = this.children[i]._x;\n            }\n            if (this.children[i]._x > maxx) {\n                maxx = this.children[i]._x;\n            }\n            maxx += 200;\n            if (this.children[i]._y > maxy) {\n                maxy = this.children[i]._y;\n            }\n            maxy += 200;\n            if (this.children[i]._y < 0 && this.children[i]._y < miny) {\n                miny = this.children[i]._y;\n            }\n            if (this.children[i]._width > maxwidth) {\n                maxwidth = this.children[i]._width;\n            }\n            if (this.children[i]._height > maxheight) {\n                maxheight = this.children[i]._height;\n            }\n        }\n        this._minx = this._x - Math.abs(minx);\n        this._miny = this._y - Math.abs(miny);\n        this._maxwidth = Math.abs(minx) + maxwidth + (maxx - this._width);\n        this._maxheight = Math.abs(miny) + maxheight + (maxy - this._height);\n        this.canvas.width = this._maxwidth;\n        this.canvas.height = this._maxheight;\n    },\n    clean: function () {\n        this.ctx.clearRect(0, 0, this._maxwidth, this._maxheight);\n    },\n    _target: function (x, y) {\n        var aa = this;\n        for (var i = this.children.length - 1; i >= 0; --i) {\n            var a = this.children[i];\n            if (a._event) {\n                var b = a.getLocalRelativeParentPoint(x, y);\n                if (a.checkPointIn(b.x, b.y)) {\n                    if (a.typeOf(\"DisplayObjectContainer\")) {\n                        aa = a.privator(\"target\", b.x, b.y);\n                    } else {\n                        aa = a;\n                    }\n                    break;\n                }\n            }\n        }\n        return aa;\n    }\n}).def({\n    name: \"Animate\",\n    extend: \"DisplayObjectContainer\",\n    init: function () {\n        var ths = this;\n        this._interval = setInterval(function () {\n            ths.onenterframe && ths.onenterframe();\n        }, 50);\n    },\n    _clear: function () {\n        for (var i in this) {\n            this[i] = null;\n        }\n        clearInterval(this._interval);\n    }\n}).def({\n    name: \"SquartDisplay\",\n    extend: \"Sprite\",\n    init: function (option) {\n        this.backgroundColor = option.backgroundColor || null;\n        this.borderSize = option.borderSize || null;\n        this.borderColor = option.borderColor || null;\n    },\n    render: function () {\n        this.ctx.globalAlpha = this._alpha;\n        if (this.backgroundColor) {\n            this.ctx.save();\n            this.ctx.fillStyle = this.backgroundColor;\n            this.ctx.fillRect(0, 0, this._width, this._height);\n            this.ctx.restore();\n        }\n        if (this.borderSize || this.borderColor) {\n            this.ctx.save();\n            this.ctx.lineWidth = this.borderSize;\n            this.ctx.strokeStyle = this.borderColor;\n            this.ctx.beginPath();\n            this.ctx.moveTo(0, 0);\n            this.ctx.lineTo(0, this._height);\n            this.ctx.lineTo(this._width, this._height);\n            this.ctx.lineTo(this._width, 0);\n            this.ctx.closePath();\n            this.ctx.stroke();\n            this.ctx.restore();\n        }\n    }\n}).def({\n    name: \"ImageDisplay\",\n    extend: \"Sprite\",\n    init: function (option) {\n        this.image = option.image;\n        this.imageType = option.imageType;\n        this.backgroundColor = option.backgroundColor || null;\n    },\n    render: function () {\n        this.ctx.globalAlpha = this._alpha;\n        if (this.backgroundColor) {\n            this.ctx.save();\n            this.ctx.fillStyle = this.backgroundColor;\n            this.ctx.fillRect(0, 0, this._width, this._height);\n            this.ctx.restore();\n        }\n        if (this.image) {\n            var image = this.image;\n            var type = this.imageType ? this.imageType : \"fit\";\n            var sprite = this;\n            if (type === \"fit\") {\n                var _w = 0, _h, _x = 0, _y = 0;\n                if (image.width > sprite._width) {\n                    _w = sprite._width;\n                    _h = (image.height / image.width) * _w;\n                    if (_h > sprite._height) {\n                        _h = sprite._height;\n                        _w = (image.width / image.height) * _h;\n                    }\n                } else {\n                    _h = sprite._height;\n                    _w = (image.width / image.height) * _h;\n                    if (_w > sprite._width) {\n                        _w = sprite._width;\n                        _h = (image.height / image.width) * _w;\n                    }\n                }\n                _x = (sprite._width - _w) / 2;\n                _y = (sprite._height - _h) / 2;\n                sprite.ctx.drawImage(image, _x, _y, _w, _h);\n            } else if (type === \"repeat\") {\n                var _w = sprite._width, _h = sprite._height, _x = 0, _y = 0;\n                while (true) {\n                    sprite.ctx.drawImage(image, _x, _y, image.width, image.height);\n                    _x += image.width;\n                    if (_x > _w) {\n                        _y += image.height;\n                        if (_y < _h) {\n                            _x = 0;\n                        } else {\n                            break;\n                        }\n                    }\n                }\n            } else if (type === \"fill\") {\n                sprite.ctx.drawImage(image, 0, 0, sprite._width, sprite._height);\n            } else if (type === \"center\") {\n                var _w = image.width, _h = image.height, _x = 0, _y = 0;\n                _x = (sprite._width - _w) / 2;\n                _y = (sprite._height - _h) / 2;\n                sprite.ctx.drawImage(image, _x, _y, _w, _h);\n            }\n        }\n    },\n    setImage: function (a, type) {\n        this.image = a;\n        this.imageType = type || \"fit\";\n        this.render();\n        this.redraw();\n        return this;\n    }\n}).def({\n    name: \"root\",\n    extend: \"DisplayObjectContainer\",\n    init: function (ops) {\n        this._parent = null;\n        this._root = null;\n        this._id = \"ROOT\";\n        var ths = this;\n        $(this.canvas).appendTo(ops.dom).click(function (e) {\n            var x = e.pageX - $(this).offset().left;\n            var y = e.pageY - $(this).offset().top;\n            var target = ths.privator(\"target\", x, y);\n            target.dispatchEvent(factory.create(\"MouseEvent\", {\n                type: \"click\",\n                pageX: x,\n                pageY: y\n            }));\n        }).bind(\"mousedown\", function (e) {\n            var x = e.pageX - $(this).offset().left;\n            var y = e.pageY - $(this).offset().top;\n            var target = ths.privator(\"target\", x, y);\n            target.dispatchEvent(factory.create(\"MouseEvent\", {\n                type: \"mousedown\",\n                pageX: x,\n                pageY: y\n            }));\n        }).bind(\"mouseup\", function (e) {\n            var x = e.pageX - $(this).offset().left;\n            var y = e.pageY - $(this).offset().top;\n            var target = ths.privator(\"target\", x, y);\n            target.dispatchEvent(factory.create(\"MouseEvent\", {\n                type: \"mouseup\",\n                pageX: x,\n                pageY: y\n            }));\n        }).bind(\"mousemove\", function (e) {\n            var x = e.pageX - $(this).offset().left;\n            var y = e.pageY - $(this).offset().top;\n            var target = ths.privator(\"target\", x, y);\n            target.dispatchEvent(factory.create(\"MouseEvent\", {\n                type: \"mousemove\",\n                pageX: x,\n                pageY: y\n            }));\n        });\n    }\n});\n$.fn.display = function (option) {\n    var ops = {\n        width: $(this).width(),\n        height: $(this).height(),\n        dom: $(this)\n    };\n    return factory.create(\"root\", $.extend(ops, option));\n};\nmodule.exports = {\n    create: function (type, option) {\n        return factory.create(type, option);\n    },\n    def: function (obj) {\n        return factory.def(obj);\n    },\n    factory: function () {\n        return factory;\n    }\n};"},{"p":"util.file","h":"4631ae8650","c":"/*!\r\n * @packet util.file;\r\n */\nvar md5 = '!function(a){if(\"object\"==typeof exports)module.exports=a();else if(\"function\"==typeof define&&define.amd)define(a);else{var b;try{b=window}catch(c){b=self}b.SparkMD5=a()}}(function(a){function b(a,b,c,d,e,f){return b=t(t(b,a),t(d,f)),t(b<<e|b>>>32-e,c)}function c(a,c,d,e,f,g,h){return b(c&d|~c&e,a,c,f,g,h)}function d(a,c,d,e,f,g,h){return b(c&e|d&~e,a,c,f,g,h)}function e(a,c,d,e,f,g,h){return b(c^d^e,a,c,f,g,h)}function f(a,c,d,e,f,g,h){return b(d^(c|~e),a,c,f,g,h)}function g(a,b){var g=a[0],h=a[1],i=a[2],j=a[3];g=c(g,h,i,j,b[0],7,-680876936),j=c(j,g,h,i,b[1],12,-389564586),i=c(i,j,g,h,b[2],17,606105819),h=c(h,i,j,g,b[3],22,-1044525330),g=c(g,h,i,j,b[4],7,-176418897),j=c(j,g,h,i,b[5],12,1200080426),i=c(i,j,g,h,b[6],17,-1473231341),h=c(h,i,j,g,b[7],22,-45705983),g=c(g,h,i,j,b[8],7,1770035416),j=c(j,g,h,i,b[9],12,-1958414417),i=c(i,j,g,h,b[10],17,-42063),h=c(h,i,j,g,b[11],22,-1990404162),g=c(g,h,i,j,b[12],7,1804603682),j=c(j,g,h,i,b[13],12,-40341101),i=c(i,j,g,h,b[14],17,-1502002290),h=c(h,i,j,g,b[15],22,1236535329),g=d(g,h,i,j,b[1],5,-165796510),j=d(j,g,h,i,b[6],9,-1069501632),i=d(i,j,g,h,b[11],14,643717713),h=d(h,i,j,g,b[0],20,-373897302),g=d(g,h,i,j,b[5],5,-701558691),j=d(j,g,h,i,b[10],9,38016083),i=d(i,j,g,h,b[15],14,-660478335),h=d(h,i,j,g,b[4],20,-405537848),g=d(g,h,i,j,b[9],5,568446438),j=d(j,g,h,i,b[14],9,-1019803690),i=d(i,j,g,h,b[3],14,-187363961),h=d(h,i,j,g,b[8],20,1163531501),g=d(g,h,i,j,b[13],5,-1444681467),j=d(j,g,h,i,b[2],9,-51403784),i=d(i,j,g,h,b[7],14,1735328473),h=d(h,i,j,g,b[12],20,-1926607734),g=e(g,h,i,j,b[5],4,-378558),j=e(j,g,h,i,b[8],11,-2022574463),i=e(i,j,g,h,b[11],16,1839030562),h=e(h,i,j,g,b[14],23,-35309556),g=e(g,h,i,j,b[1],4,-1530992060),j=e(j,g,h,i,b[4],11,1272893353),i=e(i,j,g,h,b[7],16,-155497632),h=e(h,i,j,g,b[10],23,-1094730640),g=e(g,h,i,j,b[13],4,681279174),j=e(j,g,h,i,b[0],11,-358537222),i=e(i,j,g,h,b[3],16,-722521979),h=e(h,i,j,g,b[6],23,76029189),g=e(g,h,i,j,b[9],4,-640364487),j=e(j,g,h,i,b[12],11,-421815835),i=e(i,j,g,h,b[15],16,530742520),h=e(h,i,j,g,b[2],23,-995338651),g=f(g,h,i,j,b[0],6,-198630844),j=f(j,g,h,i,b[7],10,1126891415),i=f(i,j,g,h,b[14],15,-1416354905),h=f(h,i,j,g,b[5],21,-57434055),g=f(g,h,i,j,b[12],6,1700485571),j=f(j,g,h,i,b[3],10,-1894986606),i=f(i,j,g,h,b[10],15,-1051523),h=f(h,i,j,g,b[1],21,-2054922799),g=f(g,h,i,j,b[8],6,1873313359),j=f(j,g,h,i,b[15],10,-30611744),i=f(i,j,g,h,b[6],15,-1560198380),h=f(h,i,j,g,b[13],21,1309151649),g=f(g,h,i,j,b[4],6,-145523070),j=f(j,g,h,i,b[11],10,-1120210379),i=f(i,j,g,h,b[2],15,718787259),h=f(h,i,j,g,b[9],21,-343485551),a[0]=t(g,a[0]),a[1]=t(h,a[1]),a[2]=t(i,a[2]),a[3]=t(j,a[3])}function h(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function i(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24);return c}function j(a){var b,c,d,e,f,i,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,h(a.substring(b-64,b)));for(a=a.substring(b-64),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a.charCodeAt(b)<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),i=parseInt(e[1],16)||0,d[14]=f,d[15]=i,g(k,d),k}function k(a){var b,c,d,e,f,h,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,i(a.subarray(b-64,b)));for(a=j>b-64?a.subarray(b-64):new Uint8Array(0),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a[b]<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),h=parseInt(e[1],16)||0,d[14]=f,d[15]=h,g(k,d),k}function l(a){var b,c=\"\";for(b=0;4>b;b+=1)c+=u[a>>8*b+4&15]+u[a>>8*b&15];return c}function m(a){var b;for(b=0;b<a.length;b+=1)a[b]=l(a[b]);return a.join(\"\")}function n(a){return/[\\u0080-\\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),a}function o(a,b){var c,d=a.length,e=new ArrayBuffer(d),f=new Uint8Array(e);for(c=0;d>c;c+=1)f[c]=a.charCodeAt(c);return b?f:e}function p(a){return String.fromCharCode.apply(null,new Uint8Array(a))}function q(a,b,c){var d=new Uint8Array(a.byteLength+b.byteLength);return d.set(new Uint8Array(a)),d.set(new Uint8Array(b),a.byteLength),c?d:d.buffer}function r(a){var b,c=[],d=a.length;for(b=0;d-1>b;b+=2)c.push(parseInt(a.substr(b,2),16));return String.fromCharCode.apply(String,c)}function s(){this.reset()}var t=function(a,b){return a+b&4294967295},u=[\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\"];return\"5d41402abc4b2a76b9719d911017c592\"!==m(j(\"hello\"))&&(t=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}),\"undefined\"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function b(a,b){return a=0|a||0,0>a?Math.max(a+b,0):Math.min(a,b)}ArrayBuffer.prototype.slice=function(c,d){var e,f,g,h,i=this.byteLength,j=b(c,i),k=i;return d!==a&&(k=b(d,i)),j>k?new ArrayBuffer(0):(e=k-j,f=new ArrayBuffer(e),g=new Uint8Array(f),h=new Uint8Array(this,j,e),g.set(h),f)}}(),s.prototype.append=function(a){return this.appendBinary(n(a)),this},s.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var b,c=this._buff.length;for(b=64;c>=b;b+=64)g(this._hash,h(this._buff.substring(b-64,b)));return this._buff=this._buff.substring(b-64),this},s.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d.charCodeAt(b)<<(b%4<<3);return this._finish(f,e),c=m(this._hash),a&&(c=r(c)),this.reset(),c},s.prototype.reset=function(){return this._buff=\"\",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},s.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},s.prototype.setState=function(a){return this._buff=a.buff,this._length=a.length,this._hash=a.hash,this},s.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},s.prototype._finish=function(a,b){var c,d,e,f=b;if(a[f>>2]|=128<<(f%4<<3),f>55)for(g(this._hash,a),f=0;16>f;f+=1)a[f]=0;c=8*this._length,c=c.toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(c[2],16),e=parseInt(c[1],16)||0,a[14]=d,a[15]=e,g(this._hash,a)},s.hash=function(a,b){return s.hashBinary(n(a),b)},s.hashBinary=function(a,b){var c=j(a),d=m(c);return b?r(d):d},s.ArrayBuffer=function(){this.reset()},s.ArrayBuffer.prototype.append=function(a){var b,c=q(this._buff.buffer,a,!0),d=c.length;for(this._length+=a.byteLength,b=64;d>=b;b+=64)g(this._hash,i(c.subarray(b-64,b)));return this._buff=d>b-64?new Uint8Array(c.buffer.slice(b-64)):new Uint8Array(0),this},s.ArrayBuffer.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d[b]<<(b%4<<3);return this._finish(f,e),c=m(this._hash),a&&(c=r(c)),this.reset(),c},s.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},s.ArrayBuffer.prototype.getState=function(){var a=s.prototype.getState.call(this);return a.buff=p(a.buff),a},s.ArrayBuffer.prototype.setState=function(a){return a.buff=o(a.buff,!0),s.prototype.setState.call(this,a)},s.ArrayBuffer.prototype.destroy=s.prototype.destroy,s.ArrayBuffer.prototype._finish=s.prototype._finish,s.ArrayBuffer.hash=function(a,b){var c=k(new Uint8Array(a)),d=m(c);return b?r(d):d},s}),addEventListener(\"message\",function(a){function b(){var a=g*e,b=a+1024>=c.size?c.size:a+1024;i.readAsArrayBuffer(d.call(c,a,b))}var c=a.data,d=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,e=2097152,f=Math.ceil(c.size/e),g=0,h=new SparkMD5.ArrayBuffer,i=new FileReader;i.onload=function(a){h.append(a.target.result),g++,f>g?b():postMessage(h.end())},i.onerror=function(){postMessage(null)},b()},!1);';\r\nvar uriworker = 'addEventListener(\"message\",function(c){var a=c.data;var b=new FileReader();b.onload=function(d){postMessage(d.target.result)};b.readAsDataURL(a)},false);';\r\n\r\nvar file = function (filex, type) {\r\n    var _file = filex;\r\n    this._uri=\"\";\r\n    if ($.is.isString(filex)) {\r\n        if (type) {\r\n            _file = new Blob([filex], {type: type});\r\n        } else {\r\n            this._url=filex;\r\n            _file = file.getBlobFromURI(filex);\r\n        }\r\n    } else if ($.is.isArray(filex)) {\r\n        _file = new Blob(filex, {type: (type || \"text/plain\")});\r\n    }\r\n    this.file = _file;\r\n};\r\nfile.getBlobFromURI = function (dataURL) {\r\n    var BASE64_MARKER = ';base64,';\r\n    if (dataURL.indexOf(BASE64_MARKER) === -1) {\r\n        var parts = dataURL.split(',');\r\n        var contentType = parts[0].split(':')[1];\r\n        var raw = parts[1];\r\n        return new Blob([raw], {type: contentType});\r\n    }\r\n    var parts = dataURL.split(BASE64_MARKER);\r\n    var contentType = parts[0].split(':')[1];\r\n    var byteString = atob(parts[1]);\r\n    var ab = new ArrayBuffer(byteString.length);\r\n    var ia = new Uint8Array(ab);\r\n    for (var i = 0; i < byteString.length; i++) {\r\n        ia[i] = byteString.charCodeAt(i);\r\n    }\r\n    return new Blob([ab], {type: contentType});\r\n};\r\nfile.saveAs = function (blob, filename) {\r\n    var type = blob.type;\r\n    var force_saveable_type = 'application/octet-stream';\r\n    if (type && type !== force_saveable_type) {\r\n        var slice = blob.slice || blob.webkitSlice || blob.mozSlice;\r\n        blob = slice.call(blob, 0, blob.size, force_saveable_type);\r\n    }\r\n    var url = URL.createObjectURL(blob);\r\n    var event = document.createEvent(\"MouseEvent\");\r\n    event.initMouseEvent(\"click\", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n    var t = document.createElement(\"a\");\r\n    t.href = url;\r\n    t.download = filename;\r\n    t.dispatchEvent(event);\r\n};\r\nfile.upload = function (option) {\r\n    return $.ajax({\r\n        url: option.url || null,\r\n        data: option.file,\r\n        method: \"post\",\r\n        dataType: \"json\",\r\n        timeout: option.timeout,\r\n        headers: option.headers || {},\r\n        query:option.query,\r\n        events: {\r\n            load: function (e) {\r\n                var status = e.target.status;\r\n                if ((status >= 200 && status < 300) || status === 304 || status === 0) {\r\n                    if (option.success) {\r\n                        var a = this.response.responseText;\r\n                        if (option.dataType === \"json\") {\r\n                            try {\r\n                                a = window.JSON.parse(a);\r\n                            } catch (e) {\r\n                                a = {};\r\n                            }\r\n                        }\r\n                        option.success(a);\r\n                    }\r\n                } else {\r\n                    if (option.error)\r\n                        option.error(e);\r\n                }\r\n            },\r\n            progress: function (e) {\r\n                if (option.progress) {\r\n                    option.progress({\r\n                        total: e.total,\r\n                        loaded: e.loaded,\r\n                        percent: Math.round(e.loaded * 100 / e.total)\r\n                    });\r\n                }\r\n            },\r\n            error: function (e) {\r\n                if (option.error)\r\n                    option.error(e);\r\n            }\r\n        }\r\n    });\r\n};\r\nfile.uploadAsForm = function (option) {\r\n    var formdata = new FormData();\r\n    formdata.append((option.name || \"file\"), option.file);\r\n    for (var _p in option.data) {\r\n        formdata.append(_p, option.data[_p]);\r\n    }\r\n    return $.ajax({\r\n        url: option.url || null,\r\n        data: formdata,\r\n        method: \"post\",\r\n        dataType: \"json\",\r\n        timeout: option.timeout,\r\n        query:option.query,\r\n        headers: option.headers || {},\r\n        events: {\r\n            load: function (e) {\r\n                var status = e.target.status;\r\n                if ((status >= 200 && status < 300) || status === 304 || status === 0) {\r\n                    if (option.success) {\r\n                        var a = this.response.responseText;\r\n                        if (option.dataType === \"json\") {\r\n                            try {\r\n                                a = window.JSON.parse(a);\r\n                            } catch (e) {\r\n                                a = {};\r\n                            }\r\n                        }\r\n                        option.success(a);\r\n                    }\r\n                } else {\r\n                    if (option.error)\r\n                        option.error(e);\r\n                }\r\n            },\r\n            progress: function (e) {\r\n                if (option.progress) {\r\n                    option.progress({\r\n                        total: e.total,\r\n                        loaded: e.loaded,\r\n                        percent: Math.round(e.loaded * 100 / e.total)\r\n                    });\r\n                }\r\n            },\r\n            error: function (e) {\r\n                if (option.error)\r\n                    option.error(e);\r\n            },\r\n            abort:function(){\r\n                if(option.abort){\r\n                    option.abort();\r\n                }\r\n            }\r\n        }\r\n    });\r\n};\r\nfile.prototype.isSame = function (file) {\r\n    var t = file;\r\n    if (file.file) {\r\n        t = file.getFile();\r\n    }\r\n    return this.file.lastModified === t.lastModified && this.file.size === t.size && this.file.type === t.type && this.file.name === t.name;\r\n};\r\nfile.prototype.getFile = function () {\r\n    return this.file;\r\n};\r\nfile.prototype.getFileName = function () {\r\n    return this.file ? this.file.name : \"\";\r\n};\r\nfile.prototype.getFileSize = function (type, size) {\r\n    var a = this.file.size;\r\n    if (type === \"MB\") {\r\n        a = this.file.size / (1024 * 1024);\r\n    } else if (type === \"KB\") {\r\n        a = this.file.size / 1024;\r\n    } else if (type === \"GB\") {\r\n        a = this.file.size / (1024 * 1024 * 1024);\r\n    }\r\n    if (arguments.length === 2) {\r\n        a = a.toFixed(size) / 1;\r\n    }\r\n    return a;\r\n};\r\nfile.prototype.getFileSizeAuto = function (radmon) {\r\n    var v = 0, unit = \"BYTE\", byteSize = this.file.size;\r\n    radmon = radmon || 0;\r\n    if (byteSize >= 1073741824) {\r\n        v = (byteSize / 1073741824).toFixed(radmon);\r\n        unit = \"GB\";\r\n    } else if (byteSize >= 1048576) {\r\n        v = (byteSize / 1048576).toFixed(radmon);\r\n        unit = \"MB\";\r\n    } else if (byteSize >= 1024) {\r\n        v = (byteSize / 1024).toFixed(radmon);\r\n        unit = \"KB\";\r\n    } else {\r\n        v = byteSize;\r\n        unit = \"B\";\r\n    }\r\n    return v + unit;\r\n};\r\nfile.prototype.getFileType = function () {\r\n    return this.file ? this.file.type : \"\";\r\n};\r\nfile.prototype.getFileURI = function () {\r\n    var ps = $.promise();\r\n    if(this._uri){\r\n        ps.resolve(this._uri);\r\n    }else{\r\n        var reader = new FileReader();\r\n        reader.onload = function (e) {\r\n            ps.resolve(e.target.result);\r\n        };\r\n        reader.readAsDataURL(this.file);\r\n    }\r\n    return ps;\r\n};\r\nfile.prototype.getFileURL = function () {\r\n    return window.URL.createObjectURL(this.file);\r\n};\r\nfile.prototype.getFileURIByWorker = function () {\r\n    var ps = $.promise();\r\n    var worker = new Worker(window.URL.createObjectURL(new Blob([uriworker], {type: \"text/javascript\"})));\r\n    worker.addEventListener(\"message\", function (e) {\r\n        ps.resolve(e.data);\r\n    });\r\n    worker.postMessage(this.file);\r\n    return ps;\r\n};\r\nfile.prototype.getFileHash = function () {\r\n    var ps = $.promise();\r\n    var worker = new Worker(window.URL.createObjectURL(new Blob([md5], {type: \"text/javascript\"})));\r\n    worker.addEventListener(\"message\", function (e) {\r\n        ps.resolve(e.data);\r\n    });\r\n    worker.postMessage(this.file);\r\n    return ps;\r\n};\r\nfile.prototype.getSuffix = function () {\r\n    if (this.getFileName()) {\r\n        var name = this.getFileName().split(\".\");\r\n        if (name.length > 1) {\r\n            return name[name.length - 1];\r\n        } else {\r\n            return \"\";\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\nfile.prototype.isSuffixWith = function (suffix) {\r\n    return suffix === this.getSuffix();\r\n};\r\nfile.prototype.isTypeOf = function (type) {\r\n    var typet = this.getFileType();\r\n    return typet === type;\r\n};\r\nfile.prototype.createImageElement = function () {\r\n    var ps = $.promise();\r\n    if (this.file.type.indexOf(\"image\") !== -1) {\r\n        var image = document.createElement(\"img\");\r\n        var a=this.getFileURL();\r\n        $(image).load(function () {\r\n            ps.resolve({\r\n                uri: a,\r\n                element: image\r\n            });\r\n        });\r\n        image.src = a;\r\n    } else {\r\n        ps.reject();\r\n    }\r\n    return ps;\r\n};\r\nfile.prototype.compressImage = function (quality) {\r\n    var ps = $.promise(), ths = this;\r\n    this.createImageElement().then(function (a) {\r\n        var cvs = document.createElement('canvas');\r\n        cvs.width = a.width;\r\n        cvs.height = a.height;\r\n        cvs.getContext(\"2d\").drawImage(a, 0, 0);\r\n        ps.resolve(new file(cvs.toDataURL(ths.file.type, quality / 100)));\r\n    },function () {\r\n        ps.reject();\r\n    });\r\n    return ps;\r\n};\r\nfile.prototype.createImageCanvas = function (width, height) {\r\n    var ps = $.promise();\r\n    if (this.file.type.indexOf(\"image\") !== -1) {\r\n        var a=this.getFileURL();\r\n        var image = document.createElement(\"img\");\r\n        $(image).bind(\"load\",function () {\r\n            try {\r\n                var _width = image.width, _height = image.height;\r\n                var _w = 0, _h = 0;\r\n                if (_width > width) {\r\n                    _w = width;\r\n                    _h = _height / _width * width;\r\n                    if (_h > height) {\r\n                        _h = height;\r\n                        _w = _width / _height * height;\r\n                    }\r\n                } else if (_height > height) {\r\n                    _h = height;\r\n                    _w = _width / _height * height;\r\n                    if (_w > width) {\r\n                        _w = width;\r\n                        _h = _height / _width * width;\r\n                    }\r\n                } else {\r\n                    _w = image.width;\r\n                    _h = image.height;\r\n                }\r\n                var _x = (width - _w) / 2, _y = (height - _h) / 2;\r\n                var source = image;\r\n                if (image.width > 8000 || image.height > 8000) {\r\n                    var cvs = document.createElement('canvas');\r\n                    cvs.width = image.width;\r\n                    cvs.height = image.height;\r\n                    var ctx=cvs.getContext(\"2d\");\r\n                    ctx.mozImageSmoothingEnabled = false;\r\n                    ctx.webkitImageSmoothingEnabled = false;\r\n                    ctx.msImageSmoothingEnabled = false;\r\n                    ctx.imageSmoothingEnabled = false;\r\n                    ctx.mozImageSmoothingQuality = \"low\";\r\n                    ctx.webkitImageSmoothingQuality = \"low\";\r\n                    ctx.msImageSmoothingQuality = \"low\";\r\n                    ctx.imageSmoothingQuality = \"low\";\r\n                    ctx.drawImage(image, 0, 0);\r\n                    source = cvs;\r\n                }\r\n                var cvs2 = document.createElement('canvas');\r\n                cvs2.width = width;\r\n                cvs2.height = height;\r\n                var ctx=cvs2.getContext(\"2d\");\r\n                ctx.mozImageSmoothingEnabled = false;\r\n                ctx.webkitImageSmoothingEnabled = false;\r\n                ctx.msImageSmoothingEnabled = false;\r\n                ctx.imageSmoothingEnabled = false;\r\n                ctx.mozImageSmoothingQuality = \"low\";\r\n                ctx.webkitImageSmoothingQuality = \"low\";\r\n                ctx.msImageSmoothingQuality = \"low\";\r\n                ctx.imageSmoothingQuality = \"low\";\r\n                ctx.drawImage(source, 0, 0, image.width, image.height, _x, _y, _w, _h);\r\n                ps.resolve({\r\n                    uri: a,\r\n                    element: cvs2\r\n                });\r\n            }catch (e){\r\n                console.log(e);\r\n                ps.reject({\r\n                    uri:a,\r\n                    element:null\r\n                });\r\n            }\r\n        }).bind(\"error\",function (a) {\r\n            ps.reject({\r\n                uri:a,\r\n                element:null\r\n            });\r\n        });\r\n        image.src = a;\r\n    } else {\r\n        ps.reject();\r\n    }\r\n    return ps;\r\n};\r\nfile.prototype.saveAs = function (filename) {\r\n    file.saveAs(this.file, filename);\r\n};\r\nfile.prototype.upload = function (option) {\r\n    option.file = this.file;\r\n    return file.upload(option);\r\n};\r\nfile.prototype.uploadAsForm = function (option) {\r\n    option.file = this.file;\r\n    return file.uploadAsForm(option);\r\n};\r\nfile.prototype.getChunk = function (from, size, mime) {\r\n    var blob = this.file;\r\n    var slice = blob.slice || blob.webkitSlice || blob.mozSlice;\r\n    var args = [from];\r\n    if (arguments.length === 2) {\r\n        if ($.is.isString(mime)) {\r\n            args.push(size);\r\n        } else {\r\n            args.push(from + size);\r\n        }\r\n    } else if (arguments.length === 3) {\r\n        args.push(from + size);\r\n        args.push(mime);\r\n    }\r\n    return slice.apply(blob, args);\r\n};\r\nfile.prototype.uploadChunk = function (option) {\r\n    var from = option.from, size = option.size, mime = option.mime;\r\n    var args = [];\r\n    if (from !== undefined && from !== null) {\r\n        args.push(from);\r\n    }\r\n    if (size !== undefined && size !== null) {\r\n        args.push(size);\r\n    }\r\n    if (mime !== undefined && mime !== null) {\r\n        args.push(mime);\r\n    }\r\n    option.file = this.getChunk.apply(this, args);\r\n    return file.upload(option);\r\n};\r\nfile.prototype.getChunks = function (from, size, mime) {\r\n    var ths = this;\r\n    var blob = this.file;\r\n    var slice = blob.slice || blob.webkitSlice || blob.mozSlice;\r\n    var sizet = ths.getFileSize();\r\n    var q = parseInt((sizet - from) / size);\r\n    var r = [];\r\n    for (var i = 0; i < q; i++) {\r\n        var args = [from + i * size, from + (i + 1) * size, mime];\r\n        r.push(slice.apply(blob, args));\r\n    }\r\n    r.push(slice.apply(blob, [from + q * size, sizet, mime]));\r\n    return r;\r\n};\r\nfile.prototype.uploadChunks = function (ops) {\r\n    return this.uploadChunksByPool($.extend(ops,{poolsize:1}));\r\n};\r\n\r\nmodule.exports = function (filet,type) {\r\n    return new file(filet,type);\r\n};"},{"p":"photo.service.showservice","h":"010170a762","c":"/**\r\n * @packet photo.service.showservice;\r\n */\nModule({\r\n    name:\"galleryservice\",\r\n    extend:\"localservice\",\r\n    goto:function (index) {\r\n        if(index>=0&&index<this.data.images.length){\r\n            this.data.current=index;\r\n            for(var i=0;i<this.data.thumbImages.length;i++){\r\n                this.data.thumbImages[i].active=false;\r\n            }\r\n            this.data.thumbImages[this.data.current].active=true;\r\n            this.data.currentImage=this.data.images[this.data.current];\r\n            this.trigger();\r\n        }\r\n    },\r\n    action_set:function(images){\r\n        this.data.images=images;\r\n        this.data.thumbImages=[];\r\n        this.data.current=0;\r\n        for(var i=0;i<this.data.images.length;i++){\r\n            var image=this.data.images[i];\r\n            if(image.thumb){\r\n                this.data.thumbImages.push({\r\n                    img:image.thumb,\r\n                    index:i,\r\n                    active:false\r\n                });\r\n            }\r\n        }\r\n        for(var i=0;i<this.data.thumbImages.length;i++){\r\n            this.data.thumbImages[i].active=false;\r\n        }\r\n        this.data.thumbImages[this.data.current].active=true;\r\n        this.data.currentImage=this.data.images[this.data.current];\r\n        this.trigger();\r\n        this.start();\r\n    },\r\n    service_setimages:function (array) {\r\n        this.data.images=this.data.images.concat(array);\r\n        this.data.thumbImages=[];\r\n        for(var i=0;i<this.data.images.length;i++){\r\n            var image=this.data.images[i];\r\n            if(image.thumb){\r\n                this.data.thumbImages.push({\r\n                    img:image.thumb,\r\n                    index:i\r\n                });\r\n            }\r\n        }\r\n        for(var i=0;i<this.data.thumbImages.length;i++){\r\n            this.data.thumbImages[i].active=false;\r\n        }\r\n        this.data.thumbImages[this.data.current].active=true;\r\n        this.data.currentImage=this.data.images[this.data.current];\r\n        this.trigger();\r\n    },\r\n    service_gotoimage:function (index) {\r\n        this.goto(index);\r\n    },\r\n    service_previmage:function () {\r\n        this.goto(this.data.current-1);\r\n    },\r\n    service_nextimage:function () {\r\n        this.goto(this.data.current+1);\r\n    }\r\n});"},{"p":"util.uikit","h":"1bd99ab1fb","c":"/**\r\n * @packet util.uikit;\r\n * @css util.style.uikit;\r\n */\n$.showDate = function (time) {\r\n    var a = new Date(parseInt(time));\r\n    var b = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May \", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\n    return (a.getDate() || \"\") + \" \" + (b[a.getMonth()] || \"\") + \" \" + (a.getFullYear() || \"\");\r\n};\r\n$.toast = function (text) {\r\n    $(\"<div class='toast'><div class='toast_text'>\" + text + \"</div></div>\").appendTo(\"body\").transition().set(\"-all-transform\").done(function () {\r\n        this.transition().removeAll().set(\"opacity\", {time: 1000}).delay(2000).then(function () {\r\n            this.css(\"opacity\", 0);\r\n        }).delay(1000).done(function () {\r\n            // this.remove();\r\n        }).resolve();\r\n    }).scope().transform().y(-250);\r\n};\r\n$.loadingbar = function () {\r\n    var a = $(\"#loadingbar\");\r\n    if (a.length === 0) {\r\n        a = $(\"<div id='loadingbar'>\" +\r\n            \"<div class='loadingbar-bg'></div>\" +\r\n            \"<div class='loadingbar-desc'></div></div>\").appendTo(\"body\");\r\n    }\r\n    return new loadingbar(a);\r\n};\r\nvar loadingbar = function (dom) {\r\n    this.dom = dom;\r\n};\r\nloadingbar.prototype.showLoading = function (text) {\r\n    this.dom.children(1).html(\"<i class='fa fa-repeat fa-spin'></i> \" + (text || 'Loading...'));\r\n    return this;\r\n};\r\nloadingbar.prototype.showError = function (text) {\r\n    var ps = $.promise(), ths = this;\r\n    setTimeout(function () {\r\n        ths.close();\r\n        ps.resolve();\r\n    }, 2000);\r\n    this.dom.children(1).html(\"<i class='fa fa-circle-cross'></i> \" + (text || '操作错误'));\r\n    return ps;\r\n};\r\nloadingbar.prototype.showSuccess = function (text) {\r\n    var ps = $.promise(), ths = this;\r\n    setTimeout(function () {\r\n        ths.close();\r\n        ps.resolve();\r\n    }, 2000);\r\n    this.dom.children(1).html(\"<i class='fa fa-circle-check'></i> \" + (text || '操作成功'));\r\n    return ps;\r\n};\r\nloadingbar.prototype.close = function () {\r\n    this.dom.remove();\r\n};"}],"css":[{"p":"util.style.uikit","h":"f2024b2adc","c":".toast {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: -30px;\n  height: 30px;\n  display: -webkit-box;\n  display: -moz-box;\n  display: box;\n  -webkit-box-orient: horizontal;\n  -webkit-box-pack: center;\n  -webkit-box-align: center;\n  -moz-box-pack: center;\n  -moz-box-align: center;\n  box-orient: horizontal;\n  box-pack: center;\n  box-align: center;\n  z-index: 999999999; }\n  .toast .toast_text {\n    line-height: 30px;\n    background: #5F5D5D;\n    color: white;\n    padding: 0 15px 0 15px;\n    border-radius: 15px; }\n\n#loadingbar {\n  position: fixed;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 9999999;\n  display: -webkit-box;\n  -webkit-box-orient: horizontal;\n  -webkit-box-pack: center;\n  -webkit-box-align: center;\n  display: -moz-box;\n  -moz-box-pack: center;\n  -moz-box-align: center;\n  display: box;\n  box-orient: horizontal;\n  box-pack: center;\n  box-align: center; }\n  #loadingbar .loadingbar-bg {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.05); }\n  #loadingbar .loadingbar-desc {\n    position: relative;\n    padding: 15px 20px 15px 20px;\n    background: white;\n    /*border:1px solid #F8F7F7;*/\n    -webkit-border-radius: 2px;\n    -webkit-box-shadow: 1px 2px 10px #B2B2B2;\n    -moz-border-radius: 2px;\n    -moz-box-shadow: 1px 2px 10px #B2B2B2;\n    border-radius: 2px;\n    box-shadow: 1px 2px 10px #B2B2B2; }\n"},{"p":"photo.style.gallery","h":"1cec4211d1","c":".gallery {\n  background: #333333;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  cursor: default; }\n  .gallery .gallery-canvas {\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0; }\n  .gallery .gallery-thumbs {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    background: #F3F2F3;\n    box-shadow: 0 0 10px #483E3E;\n    -webkit-transition: all .3s ease-out;\n    transition: all .3s ease-out; }\n    .gallery .gallery-thumbs .gallery-thumbs-bar {\n      width: 15px;\n      position: absolute;\n      top: 0;\n      left: 0;\n      bottom: 0;\n      text-align: center; }\n      .gallery .gallery-thumbs .gallery-thumbs-bar i {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        margin-left: -5px;\n        -webkit-transition: all .3s ease-out;\n        transition: all .3s ease-out; }\n  .gallery .gallery-desc {\n    padding: 10px;\n    background: rgba(5, 5, 5, 0.3);\n    position: absolute;\n    left: 0;\n    bottom: 30px;\n    right: 0;\n    pointer-events: none;\n    color: white; }\n  .gallery .mask {\n    width: 40px;\n    height: 40px;\n    text-align: center;\n    line-height: 40px;\n    background: white;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    margin-left: -20px;\n    margin-top: -20px;\n    border-radius: 5px; }\n    .gallery .mask .con {\n      position: absolute;\n      left: 0;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      border-radius: 5px;\n      box-shadow: 0 0 10px #403E3E inset; }\n  .gallery.close .gallery-thumbs {\n    -webkit-transform: translateX(150px);\n            transform: translateX(150px); }\n    .gallery.close .gallery-thumbs .gallery-thumbs-bar i {\n      -webkit-transform: rotate(180deg);\n              transform: rotate(180deg); }\n\n.imageviewer {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0; }\n  .imageviewer canvas {\n    position: absolute;\n    left: 0;\n    top: 0; }\n  .imageviewer .imageviewer-tools {\n    line-height: 30px;\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    text-align: center;\n    z-index: 999; }\n    .imageviewer .imageviewer-tools .imageviewer-tools-btn {\n      line-height: 30px;\n      width: 30px;\n      display: inline-block;\n      background: white;\n      vertical-align: top; }\n      .imageviewer .imageviewer-tools .imageviewer-tools-btn:hover {\n        background: #F0F0F0; }\n\n.thumblist {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  overflow: auto; }\n  .thumblist .thumblist-item {\n    height: 0;\n    border: 1px solid #D7D7D7;\n    background: white;\n    position: relative;\n    margin: 5px;\n    padding-bottom: 90%; }\n    .thumblist .thumblist-item .thumblist-item-img {\n      position: absolute;\n      left: 5px;\n      top: 5px;\n      right: 5px;\n      bottom: 5px;\n      background-color: #E9EFF8;\n      background-size: cover;\n      background-position: center;\n      background-repeat: no-repeat; }\n    .thumblist .thumblist-item.hover .thumblist-item-img:after {\n      content: \"\";\n      width: 0;\n      height: 0;\n      display: block;\n      border-top: 10px solid #4DB849;\n      border-right: 10px solid #4DB849;\n      border-bottom: 10px solid transparent;\n      border-left: 10px solid transparent;\n      color: white;\n      font-size: 12px;\n      position: absolute;\n      right: 0;\n      top: 0; }\n"},{"p":"photo.style.style","h":"79d68b4ca2","c":"@font-face {\n  font-family: 'mt-photo-icon';\n  src:\n    url('data:image/ttf;base64,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') format('truetype'),\n    url('data:image/woff;base64,d09GRgABAAAAAAhwAAsAAAAACCQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgD50E32NtYXAAAAFoAAAAhAAAAITLKXnlZ2FzcAAAAewAAAAIAAAACAAAABBnbHlmAAAB9AAAA8AAAAPAvnRUtGhlYWQAAAW0AAAANgAAADYNApg9aGhlYQAABewAAAAkAAAAJAa1A0JobXR4AAAGEAAAADQAAAA0KgAG8mxvY2EAAAZEAAAAHAAAABwDqgSybWF4cAAABmAAAAAgAAAAIAASADZuYW1lAAAGgAAAAc4AAAHOFsL/R3Bvc3QAAAhQAAAAIAAAACAAAwAAAAMDzQGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA6QEDM/80AMwDMwDMAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEAGgAAAAWABAAAwAGAAEAIOFe4ljkCeQa5dXo/+kB//3//wAAAAAAIOFe4ljkCOQZ5dXo/+kB//3//wAB/+Meph2tG/4b7xo1FwwXCwADAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAf//AA8AAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQCA/9UDgAJVAA0AAAEeAxcuAyMVCQEBqnCjcEMQKGB1iVD+1gEqAasQW4CbUDhSNhquASoBKgACAKr/qwNWAqsAAwAKAAA3IRUhAQcnMxEzEaoCrP1UAgCqqoBUAVYBVqysAar+VgABAVYAKwKSAisABQAAAQcXBwkBApLExDz/AAEAAe/ExDwBAAEAAAAAAQFuACsCqgIrAAUAAAkCJzcnAaoBAP8APMTEAiv/AP8APMTEAAAAAAQArv/ZA1YDAQAYACAAKAAwAAABHgMVFA4CBzU+AzU0LgInFSc3AzceARcVLgEDHgEXBy4BJzcOAQcjPgE3Aio/bVEvLlFuPy5OOSEhOU4uwsL8Phg1HS1VUAQVETwcIgaCEBcFVgYjHQJ9CDpbdEFCdFo7B1YHLUNVMC9VQy0Ipr7C/Rw+EhYEVgYhAQEdNRg8JVQtvhg2HC1TJgAAAAAEAKr/2QNSAwEABwAPABcAMAAAJT4BNzMOAQcHPgE3Fw4BBwEjLgEnNx4BJwc1DgMVFB4CFxUuAzU0PgI3NQLQEhUFVgYhHeQcNhg+JVYtAShWBBYSPhwitMIuTjkhITlOLj9tUS8uUW4/lxg1HS1UJSwEFhI+HSEGAXwcNhg8JlO9vqYILUNVLzBVQy0HVgc7WnRCQXRbOgiEAAABAKz/1QNWAoEAKAAAATcRITcuASMiDgIVFB4CMzI+AjczDgMjIi4CNTQ+AjMyFgLyZP7UiiJdNTVeRSgoRV41Kk0/Lw1YDj5XazxGfF01NV17R0Z9Ah1k/tSKIiooRl01Nl1FKBktPiY4XkQmNl18R0Z9XTY2AAADAID/wQNqAqsACwAXADMAAAEjFSM1IzUzNTMVMwcyNjU0JiMiBhUUFiEXByc1Jw4BIyIuAjU0PgIzMh4CFRQGBxcCAFYqVlYqVmpPcXBQT3FwAVDUQNQMJF0zOmVLLCxLZTo6ZEsrIiAMAYFWVipWVtZwUE9xcU9QcNRA1CIMICIrSmU6OWZLLCxLZjkzXSQMAAAAAwCA/8EDagKrAAMADwArAAABMxUjFzI2NTQmIyIGFRQWIRcHJzUnDgEjIi4CNTQ+AjMyHgIVFAYHFwEq1tZsT3FwUE9xcAFQ1EDUDCRdMzplSywsS2U6OmRLKyIgDAGrKqxwUE9xcU9QcNRA1CIMICIrSmU6OWZLLCxLZjkzXSQMAAAAAQAAAAEAAFtNDcdfDzz1AAsEAAAAAADVMapKAAAAANUxqkoAAP+rA4ADAQAAAAgAAgAAAAAAAAABAAADM/80AAAEAAAAAAADgAABAAAAAAAAAAAAAAAAAAAADQQAAAAAAAAAAAAAAAIAAAAEAACABAAAqgQAAVYEAAFuBAAArgQAAKoEAACsBAAAgAQAAIAAAAAAAAoAFAAeADoAUgBmAHoAygEYAVQBngHgAAEAAAANADQABAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAOAK4AAQAAAAAAAQANAAAAAQAAAAAAAgAHAJYAAQAAAAAAAwANAEgAAQAAAAAABAANAKsAAQAAAAAABQALACcAAQAAAAAABgANAG8AAQAAAAAACgAaANIAAwABBAkAAQAaAA0AAwABBAkAAgAOAJ0AAwABBAkAAwAaAFUAAwABBAkABAAaALgAAwABBAkABQAWADIAAwABBAkABgAaAHwAAwABBAkACgA0AOxtdC1waG90by1pY29uAG0AdAAtAHAAaABvAHQAbwAtAGkAYwBvAG5WZXJzaW9uIDEuMABWAGUAcgBzAGkAbwBuACAAMQAuADBtdC1waG90by1pY29uAG0AdAAtAHAAaABvAHQAbwAtAGkAYwBvAG5tdC1waG90by1pY29uAG0AdAAtAHAAaABvAHQAbwAtAGkAYwBvAG5SZWd1bGFyAFIAZQBnAHUAbABhAHJtdC1waG90by1pY29uAG0AdAAtAHAAaABvAHQAbwAtAGkAYwBvAG5Gb250IGdlbmVyYXRlZCBieSBJY29Nb29uLgBGAG8AbgB0ACAAZwBlAG4AZQByAGEAdABlAGQAIABiAHkAIABJAGMAbwBNAG8AbwBuAC4AAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA') format('woff'),\n    url('data:image/svg;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiID4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWV0YWRhdGE+R2VuZXJhdGVkIGJ5IEljb01vb248L21ldGFkYXRhPgo8ZGVmcz4KPGZvbnQgaWQ9Im10LXBob3RvLWljb24iIGhvcml6LWFkdi14PSIxMDI0Ij4KPGZvbnQtZmFjZSB1bml0cy1wZXItZW09IjEwMjQiIGFzY2VudD0iODE5LjIiIGRlc2NlbnQ9Ii0yMDQuOCIgLz4KPG1pc3NpbmctZ2x5cGggaG9yaXotYWR2LXg9IjEwMjQiIC8+CjxnbHlwaCB1bmljb2RlPSImI3gyMDsiIGhvcml6LWFkdi14PSI1MTIiIGQ9IiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGUxNWU7IiBnbHlwaC1uYW1lPSJyZXBseSIgZD0iTTQyNiA0MjYuNjY3YzI5OC00MiA0MjgtMjU2IDQ3MC00NzAtMTA2IDE1MC0yNTYgMjE4LTQ3MCAyMTh2LTE3NGwtMjk4IDI5OCAyOTggMjk4di0xNzB6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTI1ODsiIGdseXBoLW5hbWU9InZlcnRpY2FsX2FsaWduX2JvdHRvbSIgZD0iTTE3MCAwLjY2N2g2ODR2LTg2aC02ODR2ODZ6TTY4MiAyNTYuNjY3bC0xNzAtMTcyLTE3MCAxNzJoMTI4djQyNmg4NHYtNDI2aDEyOHoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlNDA4OyIgZ2x5cGgtbmFtZT0ibmF2aWdhdGVfYmVmb3JlIiBkPSJNNjU4IDQ5NC42NjdsLTE5Ni0xOTYgMTk2LTE5Ni02MC02MC0yNTYgMjU2IDI1NiAyNTZ6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTQwOTsiIGdseXBoLW5hbWU9Im5hdmlnYXRlX25leHQiIGQ9Ik00MjYgNTU0LjY2N2wyNTYtMjU2LTI1Ni0yNTYtNjAgNjAgMTk2IDE5Ni0xOTYgMTk2eiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU0MTk7IiBnbHlwaC1uYW1lPSJyb3RhdGVfbGVmdCIgZD0iTTU1NCA2MzYuNjY3YzE2OC0yMCAzMDAtMTY0IDMwMC0zMzhzLTEzMi0zMTgtMzAwLTMzOHY4NmMxMjIgMjAgMjE0IDEyNiAyMTQgMjUycy05MiAyMzItMjE0IDI1MnYtMTY2bC0xOTQgMTkwIDE5NCAxOTR2LTEzMnpNMzAyIDI4LjY2N2w2MiA2MmMzMi0yNCA2OC0zOCAxMDYtNDR2LTg2Yy02MCA4LTExOCAzMC0xNjggNjh6TTI2MCAyNTYuNjY3YzYtMzggMjAtNzQgNDItMTA2bC02MC02MGMtMzggNTAtNjAgMTA2LTY4IDE2Nmg4NnpNMzA0IDQ0Ni42NjdjLTIyLTMyLTM4LTY4LTQ0LTEwNmgtODZjOCA2MCAzMiAxMTYgNzAgMTY2eiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU0MWE7IiBnbHlwaC1uYW1lPSJyb3RhdGVfcmlnaHQiIGQ9Ik03MjAgMTUwLjY2N2MyNCAzMiAzOCA2OCA0NCAxMDZoODZjLTgtNjAtMzAtMTE2LTY4LTE2NnpNNTU0IDQ2LjY2N2MzOCA2IDc0IDIwIDEwNiA0NGw2Mi02MmMtNTAtMzgtMTA4LTYwLTE2OC02OHY4NnpNODUwIDM0MC42NjdoLTg2Yy02IDM4LTIwIDc0LTQ0IDEwNmw2MiA2MGMzOC01MCA2MC0xMDYgNjgtMTY2ek02NjQgNTc0LjY2N2wtMTk0LTE5MHYxNjZjLTEyMi0yMC0yMTQtMTI2LTIxNC0yNTJzOTItMjMyIDIxNC0yNTJ2LTg2Yy0xNjggMjAtMzAwIDE2NC0zMDAgMzM4czEzMiAzMTggMzAwIDMzOHYxMzJ6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTVkNTsiIGdseXBoLW5hbWU9InJlZnJlc2giIGQ9Ik03NTQgNTQwLjY2N2wxMDAgMTAwdi0zMDBoLTMwMGwxMzggMTM4Yy00NiA0Ni0xMTAgNzYtMTgwIDc2LTE0MiAwLTI1Ni0xMTQtMjU2LTI1NnMxMTQtMjU2IDI1Ni0yNTZjMTEyIDAgMjA4IDcwIDI0MiAxNzBoODhjLTM4LTE0OC0xNzAtMjU2LTMzMC0yNTYtMTg4IDAtMzQwIDE1NC0zNDAgMzQyczE1MiAzNDIgMzQwIDM0MmM5NCAwIDE4MC0zOCAyNDItMTAweiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU4ZmY7IiBnbHlwaC1uYW1lPSJ6b29tX2luIiBkPSJNNTEyIDM4NC42NjdoLTg2di04NmgtNDJ2ODZoLTg2djQyaDg2djg2aDQydi04Nmg4NnYtNDJ6TTQwNiAyMTIuNjY3YzEwNiAwIDE5MiA4NiAxOTIgMTkycy04NiAxOTItMTkyIDE5Mi0xOTItODYtMTkyLTE5MiA4Ni0xOTIgMTkyLTE5MnpNNjYyIDIxMi42NjdsMjEyLTIxMi02NC02NC0yMTIgMjEydjM0bC0xMiAxMmMtNDgtNDItMTEyLTY2LTE4MC02Ni0xNTQgMC0yNzggMTIyLTI3OCAyNzZzMTI0IDI3OCAyNzggMjc4IDI3Ni0xMjQgMjc2LTI3OGMwLTY4LTI0LTEzMi02Ni0xODBsMTItMTJoMzR6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTkwMTsiIGdseXBoLW5hbWU9Inpvb21fb3V0IiBkPSJNMjk4IDQyNi42NjdoMjE0di00MmgtMjE0djQyek00MDYgMjEyLjY2N2MxMDYgMCAxOTIgODYgMTkyIDE5MnMtODYgMTkyLTE5MiAxOTItMTkyLTg2LTE5Mi0xOTIgODYtMTkyIDE5Mi0xOTJ6TTY2MiAyMTIuNjY3bDIxMi0yMTItNjQtNjQtMjEyIDIxMnYzNGwtMTIgMTJjLTQ4LTQyLTExMi02Ni0xODAtNjYtMTU0IDAtMjc4IDEyMi0yNzggMjc2czEyNCAyNzggMjc4IDI3OCAyNzYtMTI0IDI3Ni0yNzhjMC02OC0yNC0xMzItNjYtMTgwbDEyLTEyaDM0eiIgLz4KPC9mb250PjwvZGVmcz48L3N2Zz4=') format('svg');\n  font-weight: normal;\n  font-style: normal;\n}\n\n.mt-photo-icon {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: 'mt-photo-icon' !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.mt-photo-navigate_before:before {\n  content: \"\\e408\";\n}\n.mt-photo-navigate_next:before {\n  content: \"\\e409\";\n}\n.mt-photo-refresh:before {\n  content: \"\\e5d5\";\n}\n.mt-photo-reply:before {\n  content: \"\\e15e\";\n}\n.mt-photo-rotate_left:before {\n  content: \"\\e419\";\n}\n.mt-photo-rotate_right:before {\n  content: \"\\e41a\";\n}\n.mt-photo-vertical_align_bottom:before {\n  content: \"\\e258\";\n}\n.mt-photo-zoom_in:before {\n  content: \"\\e8ff\";\n}\n.mt-photo-zoom_out:before {\n  content: \"\\e901\";\n}\n\n"}],"template":[{"p":"photo.template.show","h":"a53e7497ea","c":"<!--[gallery]--><div class=\"gallery-canvas\" style=\"right:<%=data.listWidth;%>px\"><@module type=\"{{data.viewerType}}\"/></div><div class=\"gallery-desc\"></div><div class=\"gallery-thumbs\" style=\"width:<%=data.listWidth;%>px\"><@module type=\"{{data.listType}}\"/></div><!--[imageviewer]--><div class=\"imageviewer-tools\"><%for(var i=0;i<data.tools.length;i++){%><div class=\"imageviewer-tools-btn\" data-bind=\"click:btn\" @cache(data.tools[i])><i class=\"mt-photo-icon <%=data.tools[i].icon;%>\"></i></div><%}%></div><!--[thumblist]--><%for(var i=0;i<data.length;i++){%><div class=\"thumblist-item<%=(data[i].active?' hover':'');%>\"\"><div class=\"thumblist-item-img\" style=\"background-image:url(<%=data[i].img;%>)\" data-bind=\"click:img\" @cache(data[i])></div></div><%}%>"}]});